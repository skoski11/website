---
title: "SQL"
output: html_document
---
```{r}
library(Lahman)
library(sqldf)
```
#Level one header
##leavel 2 header
###level 3 header

You can type normally to write paragraphs that will appear in your documents

* Item one in a list
* Item 2
* Item 3
* Item 4

This is how to make a table with multiple columns

column 1 | cloumn 2
---|---
Lions | NFC
Patriots | AFC
Buccaneers | AFC
Eagles | NFC


<img src="gsd.jpg" width="300"/>


Baseball Facts
First Fact, I absolutely hate baseball.

These are examples of ques run that gather different data and also show how we can organize how the information will be displayed, example the 4th one.

```{r}
query<-"SELECT playerID,yearID,teamID,HR FROM Batting
WHERE teamID='PHI' and yearID>=1970 and yearID<=1979 and HR>= 30"
sqldf(query)

query<-"SELECT playerID,yearID,teamID,HR FROM Batting
WHERE teamID='NYA' and HR> 40"
sqldf(query)

query<-"SELECT playerID,yearID,teamID,HR,SO FROM Batting
WHERE HR> 40 and SO<=60"
sqldf(query)

query<-"SELECT playerID,teamID,yearID,HR FROM Batting
WHERE HR>50
ORDER BY HR DESC"
sqldf(query)


# This finds and sorts who has had the fewest strikeouts in a season with atleast 400 at bats
query<-"SELECT teamID, playerID, yearID, SO, AB FROM Batting
WHERE AB>= 400 and SO< 10
ORDER BY SO"
sqldf(query)

query<-"SELECT playerID,sum(HR) FROM Batting
WHERE playerID='ruthba01'
GROUP BY playerID"
sqldf(query)

#Filter before group is where, and filter after group uses having
query<-"SELECT playerID,sum(HR) FROM Batting
GROUP BY playerID
HAVING sum(HR)>= 600
ORDER BY sum(HR) DESC"
sqldf(query)
#sum() avg() max() min() are all useable fucntions
query<-"SELECT playerID,avg(HR) FROM Batting
GROUP BY playerID
HAVING avg(HR)>= 30
ORDER BY avg(HR) DESC"
sqldf(query)

#This is us testing how to draw from multiple index at one
#Time and combine responses from these
query<-"SELECT nameFirst, nameLast, teamID, yearID, HR
FROM Batting INNER JOIN Master
On Batting.playerID=Master.playerID
WHERE Batting.playerID='ruthba01'"
sqldf(query)
#Draw from two queries

#Drew from two querries and replaced playerID with
#Real name
query<-"SELECT nameFirst, nameLast, teamID, yearID, HR
FROM Batting INNER JOIN Master
On Batting.playerID=Master.playerID
WHERE HR> 50
ORDER BY HR DESC"
sqldf(query)

query<-"SELECT playerID,name,Batting.yearID, Batting.HR
FROM Batting INNER JOIN Teams
On Batting.teamID=Teams.teamID and Batting.yearID=Teams.yearID
WHERE playerID='ruthba01'"
sqldf(query)

#This gives all the full data of all of Babe Ruth's Seasons with whole
#Names for his teams and himself
query<-"SELECT nameFirst,nameLast,name,Batting.yearID,Batting.HR 
FROM (Batting INNER JOIN Master
On Batting.playerID=Master.playerID) INNER JOIN Teams
On Batting.teamID=Teams.teamID AND Batting.yearID=Teams.yearID
WHERE Batting.playerID ='ruthba01'"
sqldf(query)


#Finds all people ever with over 600 career homeruns and gives their full name
#and team name
query<-"SELECT nameFirst,nameLast,name,sum(Batting.HR),Batting.yearID 
FROM (Batting INNER JOIN Master
On Batting.playerID=Master.playerID) INNER JOIN Teams 
On Batting.teamID=Teams.teamID AND Batting.yearID=Teams.yearID
GROUP BY Batting.playerID
HAVING sum(Batting.HR)>= 600
ORDER BY sum(Batting.HR) DESC"
sqldf(query)

#Finds people with the average salary over 1 million and the name BOB
query<-"SELECT namefirst,nameLast, avg(salary)
FROM Salaries INNER JOIN Master
On Salaries.playerID=Master.playerID
WHERE nameFirst='Bob'
GROUP BY Salaries.playerID
HAVING avg(salary) > 1000000
ORDER BY avg(salary) DESC" 
sqldf(query)



```






